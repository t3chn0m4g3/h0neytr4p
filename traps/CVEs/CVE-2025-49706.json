{
    "BasicInfo": {
        "Name": "CVE-2025-49706",
        "Port": "443",
        "Protocol": "HTTP",
        "MitreAttackTags": "T1190,T1584,T1110",
        "References": "https://github.com/AdityaBhatt3010/CVE-2025-49706-SharePoint-Spoofing-Vulnerability-Under-Active-Exploitation,https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-49706,https://nvd.nist.gov/vuln/detail/CVE-2025-49706,https://thehackernews.com/2025/07/critical-microsoft-sharepoint-flaw.html",
        "RiskRating": "8.2",
        "Description": "Microsoft SharePoint is vulnerable to a spoofing vulnerability (CVE-2025-49706) that allows attackers to craft malicious URLs and spoof headers (e.g., X-UserToken, X-Ms-Client-Request-Id) to bypass authentication, impersonate users, and potentially upload web shells. The flaw is actively exploited in the wild and can be chained for RCE."
    },
    "Behaviour": [
        {
            "Request": {
                "Method": "GET",
                "Url": "*_layouts/15/SignOut.aspx",
                "HeaderContains": {
                    "X-UserToken": ["*"],
                    "X-Ms-Client-Request-Id": ["*"]
                },
                "Params": {}
            },
            "Response": {
                "StatusCode": 302,
                "Body": "",
                "Headers": {
                    "Location": "/_layouts/15/AccessDenied.aspx?loginasanotheruser=true"
                },
                "Type": "string"
            },
            "trap": "true",
            "Note": "Detects spoofed sign-out attempts with suspicious X-UserToken or X-Ms-Client-Request-Id headers."
        },
        {
            "Request": {
                "Method": "POST",
                "Url": "*_layouts/15/upload.aspx",
                "HeaderContains": {
                    "Content-Type": ["multipart/form-data"]
                },
                "Params": {
                    "filename": ".aspx"
                }
            },
            "Response": {
                "StatusCode": 403,
                "Body": "{\"error\":\"Web shell upload attempt detected\"}",
                "Type": "json"
            },
            "trap": "true",
            "Note": "Detects web shell upload attempts via POST to upload.aspx with .aspx file. IOC: spinstall0.aspx."
        },
        {
            "Request": {
                "Method": "POST",
                "Url": "*_layouts/15/UserProfileService.asmx",
                "HeaderContains": {
                    "X-UserToken": ["*"]
                },
                "Params": {}
            },
            "Response": {
                "StatusCode": 401,
                "Body": "{\"error\":\"Suspicious spoofed request\"}",
                "Type": "json"
            },
            "trap": "true",
            "Note": "Detects spoofed POST to UserProfileService.asmx with suspicious X-UserToken."
        }
    ]
}
