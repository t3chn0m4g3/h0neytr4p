{
    "BasicInfo": {
        "Name": "CVE-2025-25257",
        "Port": "443",
        "Protocol": "HTTP",
        "MitreAttackTags": "T1190,T1566,T1059",
        "References": "https://pwner.gg/blog/2025-07-10-fortiweb-fabric-rce,https://labs.watchtowr.com/pre-auth-sql-injection-to-rce-fortinet-fortiweb-fabric-connector-cve-2025-25257/",
        "RiskRating": "9.8",
        "Description": "Fortinet FortiWeb Fabric Connector before 7.0.4 and 7.2.2 is vulnerable to a pre-auth SQL injection (SQLi) in the /api/fabric/device/status endpoint, allowing unauthenticated remote code execution (RCE) via crafted Authorization headers. Exploitation can lead to arbitrary file write and code execution as root."
    },
    "Behaviour": [
        {
            "Request": {
                "Method": "GET",
                "Url": "/api/fabric/device/status",
                "HeaderContains": {
                    "Authorization": ["or'1'='1", "or 1=1", "or+1=1", "or%271%27%3D%271", "or\u00271\u0027=\u00271", "union select", "UNION SELECT"]
                },
                "Params": {}
            },
            "Response": {
                "StatusCode": 200,
                "Body": "{\"status\":\"ok\",\"device\":\"FortiWeb\"}",
                "Type": "json"
            },
            "trap": "true",
            "Note": "SQLi test: classic tautology payload in Authorization header."
        },
        {
            "Request": {
                "Method": "GET",
                "Url": "/api/fabric/device/status",
                "HeaderContains": {
                    "Authorization": ["or'1'='2", "or 1=2", "or+1=2", "or%271%27%3D%272", "or\u00271\u0027=\u00272"]
                },
                "Params": {}
            },
            "Response": {
                "StatusCode": 401,
                "Body": "{\"error\":\"Unauthorized\"}",
                "Type": "json"
            },
            "trap": "true",
            "Note": "Negative SQLi test: should not authenticate."
        },
        {
            "Request": {
                "Method": "GET",
                "Url": "/api/fabric/device/status",
                "HeaderContains": {
                    "Authorization": ["UNION SELECT", "union select", "INTO OUTFILE", "into outfile", "fabric_user.user_table"]
                },
                "Params": {}
            },
            "Response": {
                "StatusCode": 500,
                "Body": "{\"error\":\"Internal Server Error\"}",
                "Type": "json"
            },
            "trap": "true",
            "Note": "Attempt to exploit file write via SQLi (INTO OUTFILE)."
        },
        {
            "Request": {
                "Method": "GET",
                "Url": "/cgi-bin/ml-draw.py",
                "Headers": {},
                "Params": {}
            },
            "Response": {
                "StatusCode": 200,
                "Body": "traps/assets/default/default.html",
                "Type": "file"
            },
            "trap": "true",
            "Note": "Access to CGI endpoint used for RCE after file write."
        }
    ]
}
